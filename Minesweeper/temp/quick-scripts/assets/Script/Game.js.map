{"version":3,"sources":["Game.js"],"names":["GAME_STATE","cc","Enum","PREPARE","PLAY","DEAD","WIN","TOUCH_STATE","BLANK","FLAG","Class","extends","Component","properties","tilesLayout","Node","tile","Prefab","btnShow","tiles","picPrepare","SpriteFrame","picPlay","picDead","picWin","gameState","default","type","touchState","row","col","bombNum","onLoad","Tile","require","self","y","x","instantiate","name","String","on","EventType","MOUSE_UP","event","getButton","Event","EventMouse","BUTTON_LEFT","BUTTON_RIGHT","onTouchTile","addChild","push","newGame","n","length","getComponent","TYPE","ZERO","state","STATE","NONE","tilesIndex","i","j","Math","floor","random","BOMB","splice","k","tempBomb","roundTiles","tileRound","m","Sprite","spriteFrame","touchTile","CLIKED","gameOver","testTiles","testTile","pop","parseInt","judgeWin","DOUBT","confNum","onBtnShow"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const GAME_STATE = cc.Enum({\r\n    PREPARE: -1,\r\n    PLAY: -1,\r\n    DEAD: -1,\r\n    WIN: -1\r\n});\r\nconst TOUCH_STATE = cc.Enum({\r\n    BLANK: -1,\r\n    FLAG: -1,\r\n});\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        tilesLayout: cc.Node,\r\n        tile: cc.Prefab,\r\n        btnShow: cc.Node,\r\n        tiles: [],//用一个数组保存所有tile的引用，数组下标就是相应tile的tag\r\n        picPrepare: cc.SpriteFrame,\r\n        picPlay: cc.SpriteFrame,\r\n        picDead: cc.SpriteFrame,\r\n        picWin: cc.SpriteFrame,\r\n        gameState: {\r\n            default: GAME_STATE.PREPARE,\r\n            type: GAME_STATE,\r\n        },\r\n        touchState: {//左键点开tile，右键插旗\r\n            default: TOUCH_STATE.BLANK,\r\n            type: TOUCH_STATE,\r\n        },\r\n        row: 0,\r\n        col: 0,\r\n        bombNum: 0,\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.Tile = require(\"Tile\");\r\n        var self = this;\r\n        for (let y = 0; y < this.row; y++) {\r\n            for (let x = 0; x < this.col; x++) {\r\n                let tile = cc.instantiate(this.tile);\r\n                tile.name = String(y * this.col + x);\r\n                tile.on(cc.Node.EventType.MOUSE_UP, function (event) {\r\n                    if (event.getButton() === cc.Event.EventMouse.BUTTON_LEFT) {\r\n                        self.touchState = TOUCH_STATE.BLANK;\r\n                    } else if (event.getButton() === cc.Event.EventMouse.BUTTON_RIGHT) {\r\n                        self.touchState = TOUCH_STATE.FLAG;\r\n                    }\r\n                    self.onTouchTile(tile);\r\n                });\r\n                this.tilesLayout.addChild(tile);\r\n                this.tiles.push(tile);\r\n            }\r\n        }\r\n        this.newGame();\r\n    },\r\n\r\n    newGame: function () {\r\n        //初始化场景\r\n        for (let n = 0; n < this.tiles.length; n++) {\r\n            this.tiles[n].getComponent(\"Tile\").type = this.Tile.TYPE.ZERO;\r\n            this.tiles[n].getComponent(\"Tile\").state = this.Tile.STATE.NONE;\r\n        }\r\n        //添加雷\r\n        var tilesIndex = [];\r\n        for (var i = 0; i < this.tiles.length; i++) {\r\n            tilesIndex[i] = i;\r\n        }\r\n        for (var j = 0; j < this.bombNum; j++) {\r\n            var n = Math.floor(Math.random() * tilesIndex.length);\r\n            this.tiles[tilesIndex[n]].getComponent(\"Tile\").type = this.Tile.TYPE.BOMB;\r\n            tilesIndex.splice(n, 1);//从第n个位置删除一个元素\r\n            //如果没有splice方法可以用这种方式\r\n            // tilesIndex[n] = tilesIndex[tilesIndex.length-1];\r\n            // tilesIndex.length--;\r\n        }\r\n        //标记雷周围的方块\r\n        for (var k = 0; k < this.tiles.length; k++) {\r\n            var tempBomb = 0;\r\n            if (this.tiles[k].getComponent(\"Tile\").type == this.Tile.TYPE.ZERO) {\r\n                var roundTiles = this.tileRound(k);\r\n                for (var m = 0; m < roundTiles.length; m++) {\r\n                    if (roundTiles[m].getComponent(\"Tile\").type == this.Tile.TYPE.BOMB) {\r\n                        tempBomb++;\r\n                    }\r\n                }\r\n                this.tiles[k].getComponent(\"Tile\").type = tempBomb;\r\n            }\r\n        }\r\n\r\n        this.gameState = GAME_STATE.PLAY;\r\n        this.btnShow.getComponent(cc.Sprite).spriteFrame = this.picPlay;\r\n    },\r\n\r\n    //返回tag为i的tile的周围tile数组\r\n    tileRound: function (i) {\r\n        var roundTiles = [];\r\n        if (i % this.col > 0) {//left\r\n            roundTiles.push(this.tiles[i - 1]);\r\n        }\r\n        if (i % this.col > 0 && Math.floor(i / this.col) > 0) {//left top\r\n            roundTiles.push(this.tiles[i - this.col - 1]);\r\n        }\r\n        if (i % this.col > 0 && Math.floor(i / this.col) < this.row - 1) {//left bottom\r\n            roundTiles.push(this.tiles[i + this.col - 1]);\r\n        }\r\n        if (Math.floor(i / this.col) > 0) {//bottom\r\n            roundTiles.push(this.tiles[i - this.col]);\r\n        }\r\n        if (Math.floor(i / this.col) < this.row - 1) {//top\r\n            roundTiles.push(this.tiles[i + this.col]);\r\n        }\r\n        if (i % this.col < this.col - 1) {//right\r\n            roundTiles.push(this.tiles[i + 1]);\r\n        }\r\n        if (i % this.col < this.col - 1 && Math.floor(i / this.col) > 0) {//rihgt top\r\n            roundTiles.push(this.tiles[i - this.col + 1]);\r\n        }\r\n        if (i % this.col < this.col - 1 && Math.floor(i / this.col) < this.row - 1) {//right bottom\r\n            roundTiles.push(this.tiles[i + this.col + 1]);\r\n        }\r\n        return roundTiles;\r\n    },\r\n\r\n    onTouchTile: function (touchTile) {\r\n        if (this.gameState != GAME_STATE.PLAY) {\r\n            return;\r\n        }\r\n        switch (this.touchState) {\r\n            case TOUCH_STATE.BLANK:\r\n                if (touchTile.getComponent(\"Tile\").type === this.Tile.TYPE.BOMB) {\r\n                    touchTile.getComponent(\"Tile\").state = this.Tile.STATE.CLIKED;\r\n                    this.gameOver();\r\n                    return;\r\n                }\r\n                var testTiles = [];\r\n                if (touchTile.getComponent(\"Tile\").state === this.Tile.STATE.NONE) {\r\n                    testTiles.push(touchTile);\r\n                    while (testTiles.length) {\r\n                        var testTile = testTiles.pop();\r\n                        if (testTile.getComponent(\"Tile\").type === 0) {\r\n                            testTile.getComponent(\"Tile\").state = this.Tile.STATE.CLIKED;\r\n                            var roundTiles = this.tileRound(parseInt(testTile.name));\r\n                            for (var i = 0; i < roundTiles.length; i++) {\r\n                                if (roundTiles[i].getComponent(\"Tile\").state == this.Tile.STATE.NONE) {\r\n                                    testTiles.push(roundTiles[i]);\r\n                                }\r\n                            }\r\n                        } else if (testTile.getComponent(\"Tile\").type > 0 && testTile.getComponent(\"Tile\").type < 9) {\r\n                            testTile.getComponent(\"Tile\").state = this.Tile.STATE.CLIKED;\r\n                        }\r\n                    }\r\n                    this.judgeWin();\r\n                }\r\n\r\n                break;\r\n            case TOUCH_STATE.FLAG:\r\n                if (touchTile.getComponent(\"Tile\").state == this.Tile.STATE.NONE) {\r\n                    touchTile.getComponent(\"Tile\").state = this.Tile.STATE.FLAG;\r\n                } else if (touchTile.getComponent(\"Tile\").state == this.Tile.STATE.FLAG) {\r\n                    touchTile.getComponent(\"Tile\").state = this.Tile.STATE.DOUBT;\r\n                }else{\r\n                    touchTile.getComponent(\"Tile\").state = this.Tile.STATE.NONE;\r\n                }\r\n                break;\r\n            default: break;\r\n        }\r\n\r\n    },\r\n\r\n    judgeWin: function () {\r\n        var confNum = 0;\r\n        //判断是否胜利\r\n        for (let i = 0; i < this.tiles.length; i++) {\r\n            if (this.tiles[i].getComponent(\"Tile\").state === this.Tile.STATE.CLIKED) {\r\n                confNum++;\r\n            }\r\n        }\r\n        if (confNum === this.tiles.length - this.bombNum) {\r\n            this.gameState = GAME_STATE.WIN;\r\n            this.btnShow.getComponent(cc.Sprite).spriteFrame = this.picWin;\r\n        }\r\n    },\r\n\r\n    gameOver: function () {\r\n        this.gameState = GAME_STATE.DEAD;\r\n        this.btnShow.getComponent(cc.Sprite).spriteFrame = this.picDead;\r\n    },\r\n\r\n\r\n    onBtnShow: function () {\r\n        if (this.gameState === GAME_STATE.PREPARE) {\r\n            this.newGame();\r\n        }\r\n        if (this.gameState === GAME_STATE.DEAD) {\r\n            // this.bombNum--;\r\n            this.newGame();\r\n        }\r\n        if (this.gameState === GAME_STATE.WIN) {\r\n            // this.bombNum++;\r\n            this.newGame();\r\n        }\r\n    }\r\n\r\n});\r\n"]}